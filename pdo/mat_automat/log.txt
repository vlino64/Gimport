SELECT uc.*,m.nom_materia AS materia,g.idgrups,g.nom AS grup,mmuf.id_mat_uf_pla,gm.automatricula,gm.contrasenya FROM unitats_classe uc INNER JOIN dies_franges          df ON uc.id_dies_franges    = df.id_dies_franges INNER JOIN prof_agrupament       pa ON uc.idgrups_materies   = pa.idagrups_materies INNER JOIN grups_materies        gm ON uc.idgrups_materies   = gm.idgrups_materies INNER JOIN grups                  g ON gm.id_grups           = g.idgrups INNER JOIN materia                m ON gm.id_mat_uf_pla      = m.idmateria INNER JOIN moduls_materies_ufs mmuf ON m.idmateria           = mmuf.id_mat_uf_pla WHERE df.idperiode_escolar=6 AND pa.idprofessors='438' GROUP BY uc.idgrups_materies UNION SELECT uc.*,CONCAT(LEFT(m.nom_modul,20),'-',uf.nom_uf) AS materia,g.idgrups,g.nom AS grup,mmuf.id_mat_uf_pla,gm.automatricula,gm.contrasenya FROM unitats_classe uc INNER JOIN dies_franges          df ON uc.id_dies_franges      = df.id_dies_franges INNER JOIN prof_agrupament       pa ON uc.idgrups_materies     = pa.idagrups_materies INNER JOIN grups_materies        gm ON uc.idgrups_materies     = gm.idgrups_materies INNER JOIN grups                  g ON gm.id_grups             = g.idgrups INNER JOIN unitats_formatives    uf ON gm.id_mat_uf_pla        = uf.idunitats_formatives INNER JOIN moduls_materies_ufs mmuf ON uf.idunitats_formatives = mmuf.id_mat_uf_pla INNER JOIN moduls_ufs            mu ON uf.idunitats_formatives = mu.id_ufs INNER JOIN moduls                 m ON mu.id_moduls            = m.idmoduls WHERE df.idperiode_escolar=6 AND pa.idprofessors='438' GROUP BY uc.idgrups_materies ORDER BY 5,6 asc 